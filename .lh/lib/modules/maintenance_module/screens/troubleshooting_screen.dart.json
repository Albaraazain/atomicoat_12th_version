{
    "sourceFile": "lib/modules/maintenance_module/screens/troubleshooting_screen.dart",
    "activeCommit": 0,
    "commits": [
        {
            "activePatchIndex": 0,
            "patches": [
                {
                    "date": 1734535222589,
                    "content": "Index: \n===================================================================\n--- \n+++ \n"
                }
            ],
            "date": 1734535222589,
            "name": "Commit-0",
            "content": "import 'package:flutter/material.dart';\r\nimport '../models/troubleshooting_step.dart';\r\nimport '../widgets/troubleshooting_tree_widget.dart';\r\n\r\nclass TroubleshootingScreen extends StatefulWidget {\r\n  @override\r\n  _TroubleshootingScreenState createState() => _TroubleshootingScreenState();\r\n}\r\n\r\nclass _TroubleshootingScreenState extends State<TroubleshootingScreen> {\r\n  late List<TroubleshootingStep> _troubleshootingSteps;\r\n  int _currentStepIndex = 0;\r\n\r\n  @override\r\n  void initState() {\r\n    super.initState();\r\n    _troubleshootingSteps = _initializeTroubleshootingSteps();\r\n  }\r\n\r\n  List<TroubleshootingStep> _initializeTroubleshootingSteps() {\r\n    // This is a simplified example. In a real app, this data might come from a database or API.\r\n    return [\r\n      TroubleshootingStep(\r\n        question: 'What is the main issue you are experiencing?',\r\n        options: ['Poor film uniformity', 'Unexpected growth rates', 'Pressure control problems', 'Temperature fluctuations'],\r\n      ),\r\n      TroubleshootingStep(\r\n        question: 'For poor film uniformity, check the following:',\r\n        options: ['Precursor flow rates', 'Substrate temperature uniformity', 'Chamber pressure stability'],\r\n      ),\r\n      // Add more steps as needed\r\n    ];\r\n  }\r\n\r\n  void _handleOptionSelected(String selectedOption) {\r\n    setState(() {\r\n      if (_currentStepIndex < _troubleshootingSteps.length - 1) {\r\n        _currentStepIndex++;\r\n      } else {\r\n        // Reached the end of the troubleshooting tree\r\n        _showFinalRecommendation(selectedOption);\r\n      }\r\n    });\r\n  }\r\n\r\n  void _showFinalRecommendation(String finalOption) {\r\n    showDialog(\r\n      context: context,\r\n      builder: (ctx) => AlertDialog(\r\n        title: Text('Recommendation'),\r\n        content: Text('Based on your selections, we recommend the following action: $finalOption'),\r\n        actions: [\r\n          TextButton(\r\n            onPressed: () {\r\n              Navigator.of(ctx).pop();\r\n              _resetTroubleshooting();\r\n            },\r\n            child: Text('Start Over'),\r\n          ),\r\n          TextButton(\r\n            onPressed: () => Navigator.of(ctx).pop(),\r\n            child: Text('Close'),\r\n          ),\r\n        ],\r\n      ),\r\n    );\r\n  }\r\n\r\n  void _resetTroubleshooting() {\r\n    setState(() {\r\n      _currentStepIndex = 0;\r\n    });\r\n  }\r\n\r\n  @override\r\n  Widget build(BuildContext context) {\r\n    return Scaffold(\r\n      appBar: AppBar(\r\n        leading: IconButton(\r\n          icon: Icon(Icons.menu),\r\n          onPressed: () {\r\n            Scaffold.of(context).openDrawer();\r\n          },\r\n        ),\r\n        title: Text('Troubleshooting Guide'),\r\n        actions: [\r\n          IconButton(\r\n            icon: Icon(Icons.refresh),\r\n            onPressed: _resetTroubleshooting,\r\n            tooltip: 'Start Over',\r\n          ),\r\n        ],\r\n      ),\r\n      body: SingleChildScrollView(\r\n        child: Padding(\r\n          padding: const EdgeInsets.all(16.0),\r\n          child: Column(\r\n            crossAxisAlignment: CrossAxisAlignment.start,\r\n            children: [\r\n              Text(\r\n                'Step ${_currentStepIndex + 1} of ${_troubleshootingSteps.length}',\r\n                style: TextStyle(fontSize: 18, fontWeight: FontWeight.bold),\r\n              ),\r\n              SizedBox(height: 16),\r\n              TroubleshootingTreeWidget(\r\n                steps: _troubleshootingSteps,\r\n                onOptionSelected: _handleOptionSelected,\r\n              )\r\n            ],\r\n          ),\r\n        ),\r\n      ),\r\n    );\r\n  }\r\n}\r\n"
        }
    ]
}